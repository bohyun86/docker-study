
### TCP와 UDP
먼저 **TCP**와 **UDP**는 네트워크 통신을 위한 주요 **전송 프로토콜**입니다. 둘 다 데이터를 전송하는 역할을 하지만, 사용 목적과 특성에서 차이가 있습니다.

#### 1. TCP (Transmission Control Protocol)
- **신뢰성 있는 연결**: **TCP**는 데이터를 보내고 받을 때 **신뢰성을 보장**합니다. 즉, 데이터를 보낼 때 수신자가 데이터를 제대로 받았는지 확인하며, 데이터가 손실되거나 손상되면 다시 전송하는 **오류 수정** 기능을 갖추고 있습니다.
- **연결 기반 프로토콜**: 데이터를 전송하기 전에 **송신자와 수신자 간의 연결**이 이루어집니다. 이로 인해 데이터가 순서에 맞게 도착하고, 손실 없이 전달되도록 합니다.
- **응용 사례**: 파일 전송, 웹 브라우징, 이메일 등 **신뢰성이 중요한 통신**에 사용됩니다.

Docker Swarm에서는 **2377/tcp** 포트를 통해 **클라이언트와 Swarm 간의 안전한 통신**을 유지합니다. 이 포트는 클러스터 내 명령을 전달하거나 관리할 때 사용됩니다.

#### 2. UDP (User Datagram Protocol)
- **비연결 기반 프로토콜**: **UDP**는 연결을 설정하지 않고 데이터를 전송합니다. TCP와 달리, 데이터가 도착했는지 확인하지 않으며 **오류 수정 기능**도 제공하지 않습니다. 대신, **속도**가 매우 빠릅니다.
- **신뢰성보다는 속도 우선**: 데이터가 순서에 맞지 않게 도착하거나 일부 데이터가 손실될 수 있지만, 이러한 점이 크게 문제가 되지 않는 상황에서 유용합니다.
- **응용 사례**: 스트리밍 서비스, 온라인 게임 등 **속도가 중요한 실시간 통신**에 사용됩니다.

Docker Swarm에서는 **7946/tcp 및 udp**를 사용하여 클러스터의 **컨트롤 플레인 정보(gossip 통신)**를 교환합니다. **gossip 통신**은 클러스터 내의 노드들이 서로의 상태를 공유하고, 네트워크의 변경 사항을 전달하기 위한 것입니다. UDP를 사용하는 이유는 빠른 정보 전달을 위해 신뢰성보다는 **속도**가 중요한 부분이기 때문입니다.

### VXLAN 기반 오버레이 네트워크
#### 1. VXLAN (Virtual Extensible LAN)
**VXLAN**은 물리적인 네트워크 한계를 넘어서 가상 환경에서 **여러 네트워크를 확장**할 수 있도록 해주는 **오버레이 네트워크 프로토콜**입니다.

- **오버레이 네트워크**란?  
  오버레이 네트워크는 물리적인 네트워크 위에 또 하나의 가상 네트워크를 **겹쳐서 구성**한 것입니다. 이를 통해 여러 호스트에 걸쳐 있는 컨테이너들이 마치 동일한 네트워크에 있는 것처럼 작동할 수 있습니다. 즉, 물리적으로 떨어져 있는 컨테이너들이 서로 통신할 수 있도록 해줍니다.

- **VXLAN의 목적**:
    - **네트워크 확장**: 기존의 VLAN(Virtual LAN)으로는 네트워크 ID를 최대 4096개까지만 사용할 수 있었지만, VXLAN은 이를 16백만 개 이상으로 확장할 수 있습니다. 이를 통해 대규모 클라우드 환경에서도 충분한 네트워크 세그먼트를 사용할 수 있습니다.
    - **격리와 보안**: 각 오버레이 네트워크는 다른 네트워크와 격리되어 작동하므로, 보안적으로도 장점이 있습니다. 동일한 물리적 네트워크 위에 여러 오버레이 네트워크가 존재할 수 있지만, 이들은 서로 접근할 수 없습니다.

- **Docker Swarm에서 VXLAN 사용**:
  Docker Swarm에서는 **4789/udp 포트**를 사용하여 **VXLAN 기반 오버레이 네트워크**를 설정합니다. 이를 통해 Docker 노드들 간에 **컨테이너들이 서로 네트워크 상에서 안전하게 통신**할 수 있게 됩니다. 오버레이 네트워크를 사용함으로써, 물리적인 네트워크 구성을 변경하지 않아도 노드 간의 컨테이너 통신을 용이하게 할 수 있습니다.

VXLAN 오버레이 네트워크는 특히 다수의 Docker 호스트에 걸쳐 있는 컨테이너들이 동일한 네트워크처럼 느껴지도록 해주는 데 매우 유용하며, 이로 인해 다양한 위치에 있는 컨테이너들이 마치 동일한 LAN에 있는 것처럼 자유롭게 통신할 수 있게 해줍니다.

### 요약
- **TCP**는 신뢰성이 중요한 경우에 데이터를 전송하며, 클러스터 명령 통신에 사용됩니다.
- **UDP**는 속도가 중요한 경우 사용되며, 컨트롤 플레인 가십 통신에 사용됩니다.
- **VXLAN 기반 오버레이 네트워크**는 물리적 한계를 넘어 가상 네트워크를 확장하여 여러 노드 간의 컨테이너 통신을 가능하게 해줍니다.

이러한 모든 네트워크 프로토콜과 구성 요소들을 통해 Docker Swarm 클러스터는 효율적이고 안전한 클러스터 환경을 제공하며, 다양한 노드들이 하나의 클러스터에서 안정적으로 협력할 수 있게 합니다.